## 1. 项目目录关系分析

### src目录
- **定位**：项目核心源代码目录，包含所有主要功能模块
- **功能划分**：
  - `common/`：通用工具模块，包括配置管理、文件操作、日志记录等
  - `extend_mode/`：扩展模式功能，用于将中文字符串映射到英文
  - `extract_mode/`：提取模式功能，用于从源代码中提取字符串
- **核心文件**：
  - `common/tree_sitter_utils.py`：基于Tree-sitter的字符串提取实现
  - `common/yaml_utils.py`：YAML映射规则处理

### scripts目录
- **定位**：项目辅助脚本目录，包含独立运行的工具脚本
- **功能**：提供基于核心功能的扩展工具
- **文件**：
  - `generate_mapping_rules.py`：自动生成映射规则
  - `process_unmapped.py`：处理未映射内容

### 目录关系
- `scripts` 目录依赖 `src` 目录中的核心功能模块
- `scripts` 中的脚本通过导入 `src.common` 中的模块来使用核心功能
- `src` 目录是项目的核心实现，`scripts` 目录是基于核心功能的扩展工具

## 2. 字符串提取功能清理计划

### 需要清理的文件和代码
1. **`src/extract_mode/string_extractor.py`**：基于javalang和正则表达式的字符串提取实现
2. **`src/extract_mode/extractor.py`**：集成多种字符串提取方案的实现
3. **相关引用**：移除对这些备用实现的引用

### 清理步骤

#### 步骤1：修改`extract_mode/core.py`
- 移除对`src.extract_mode.extractor`和`src.extract_mode.string_extractor`的引用
- 替换为直接使用`common.tree_sitter_utils`和`common.yaml_utils`
- 更新字符串提取逻辑，只使用Tree-sitter实现

#### 步骤2：修改`common/tools_integrator.py`
- 移除与ast-grep相关的代码，只保留必要的工具集成功能

#### 步骤3：删除`src/extract_mode/string_extractor.py`
- 该文件包含基于javalang和正则表达式的备用提取实现
- 清理后不再需要

#### 步骤4：删除`src/extract_mode/extractor.py`
- 该文件集成了多种字符串提取方案
- 清理后只使用`common.tree_sitter_utils`

#### 步骤5：更新`scripts/generate_mapping_rules.py`
- 确保脚本只使用`common.tree_sitter_utils`和`common.yaml_utils`

## 3. 清理后验证

### 功能验证
- 运行提取模式，验证字符串提取功能正常
- 运行扩展模式，验证字符串映射功能正常
- 运行`generate_mapping_rules.py`脚本，验证映射规则生成功能正常

### 代码验证
- 确保所有导入语句正确
- 确保没有未定义的变量或函数
- 确保代码能够正常编译和运行

## 4. 预期结果

- 移除了所有用于字符串提取的备用实现
- 程序只使用`common.tree_sitter_utils.py`和`common.yaml_utils.py`进行字符串提取操作
- 代码结构更加清晰，维护性更高
- 功能完整性得到保证

## 5. 风险评估

- **风险**：清理后可能导致某些功能无法正常工作
- **缓解措施**：
  - 详细测试所有功能
  - 保留原始代码备份，以便在出现问题时恢复
  - 逐步清理，每次清理后进行测试

## 6. 清理文件列表

1. `src/extract_mode/string_extractor.py`
2. `src/extract_mode/extractor.py`
3. 修改`src/extract_mode/core.py`
4. 修改`src/common/tools_integrator.py`
5. 修改`scripts/generate_mapping_rules.py`