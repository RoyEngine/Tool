# 优化报告生成路径计划（只使用新保存逻辑）

## 问题分析

当前报告生成逻辑存在以下问题：
1. 报告统一生成在 `Localization_File/output/Extract/Report/` 目录下，与规则文件位置分离
2. 未根据规则类型（常规提取规则/映射规则）生成不同位置的报告
3. 报告生成路径与规则文件位置缺乏逻辑一致性

## 优化方案

### 1. 修改报告保存逻辑

**核心思路**：根据规则类型和处理流程，将报告生成在与规则文件相关联的目录中，不保留备份

**具体修改**：

#### 1.1 修改 `src/common/report_utils.py`

- 增强 `save_report` 函数，添加 `rule_type` 和 `mod_name` 参数
- 根据 `rule_type` 确定报告保存路径

#### 1.2 修改 `src/extract_mode/core.py`

- 对于常规提取规则，将报告生成在 `rule/{language}/{mod_name}` 目录下
- **移除**原有报告保存到 `Localization_File/output/Extract/Report/` 的逻辑
- 只保留报告生成到规则文件目录的逻辑

#### 1.3 修改 `src/extend_mode/core.py`

- 对于映射规则，将报告放置在映射文件夹下
  - 英文到中文映射：`output/Extend_en2zh/{mod_name}/`
  - 中文到英文映射：`output/Extend_zh2en/{mod_name}/`
- **移除**其他报告保存逻辑

### 2. 确保逻辑一致性

**规则文件与报告位置对应关系**：

| 规则类型 | 规则文件位置 | 报告生成位置 |
|---------|-------------|-------------|
| 常规提取规则 | `rule/English/qualitycaptains/` | `rule/English/qualitycaptains/` |
| 映射规则(英文到中文) | - | `output/Extend_en2zh/qualitycaptains/` |
| 映射规则(中文到英文) | - | `output/Extend_zh2en/qualitycaptains/` |

### 3. 禁止移动现有文件夹

- 确保代码中没有移动 `Extract_Complete` 文件夹的逻辑
- 只修改报告生成路径，不影响其他文件结构

## 修复步骤

1. 编辑 `src/common/report_utils.py`，增强 `save_report` 函数
2. 编辑 `src/extract_mode/core.py`，修改报告保存逻辑，只保存到规则文件目录
3. 编辑 `src/extend_mode/core.py`，修改报告保存逻辑，只保存到映射文件夹
4. 测试修复效果，确保报告生成在正确位置

## 预期效果

- 报告文件与规则文件位置保持逻辑一致性
- 便于用户查找和管理报告
- 保持现有文件夹结构不变
- 支持不同类型规则的报告生成需求
- 不再生成多余的备份报告