## 问题分析

1. **Localization_File目录生成位置错误**：
   - 当`get_directory("tool_root")`获取失败时，`base_path`被错误设置为`Localization_Tool`目录
   - 导致`Localization_File`目录被创建在`Localization_Tool`内部，而非同级目录

2. **Extract_Complete和Extend目录生成机制**：
   - 这些目录通过`os.path.join(base_path, "Localization_File", "output", "Extract_Complete")`创建
   - 当`base_path`错误时，它们也会被创建在错误的位置

3. **目录结构规范性问题**：
   - 当前结构：`D:\Poki\Tool\Localization_Tool\Localization_File`（错误）
   - 正确结构：`D:\Poki\Tool\Localization_File`（与Localization_Tool同级）

## 修复方案

1. **修复base_path计算逻辑**：
   - 确保`base_path`始终指向`Localization_Tool`目录
   - 改进`get_directory("tool_root")`的实现，确保它能正确返回工具根目录

2. **修复Localization_File路径计算**：
   - 确保所有代码中使用的`Localization_File`路径都通过正确的方式计算
   - 避免直接使用`os.path.join(base_path, "Localization_File")`这样的错误写法
   - 统一使用`os.path.join(os.path.dirname(base_path), "Localization_File")`或通过配置获取

3. **修复Extract_Complete和Extend目录生成**：
   - 更新所有相关代码，确保这些目录被创建在正确的`Localization_File`目录下
   - 使用配置管理器获取正确的输出目录路径

4. **清理错误生成的目录**：
   - 删除错误位置的`Localization_File`目录
   - 确保正确位置的`Localization_File`目录存在且结构正确

## 具体修改点

1. **修改`extract_mode/core.py`**：
   - 第322行：将`complete_path = os.path.join(base_path, "Localization_File", "output", "Extract_Complete")`
   - 修改为：使用配置管理器获取正确的Localization_File路径

2. **修改其他可能存在类似问题的文件**：
   - 检查`extend_mode/core.py`等文件中的目录计算逻辑
   - 确保所有目录路径都通过正确的方式获取

3. **改进`config_utils.py`中的目录计算**：
   - 确保`get_directory("tool_root")`始终返回正确的工具根目录
   - 改进`_resolve_directory_config`方法，确保目录路径计算正确

## 测试验证

1. **验证目录结构**：
   - 运行工具后，检查`Localization_File`目录是否位于正确位置
   - 检查`Extract_Complete`和`Extend`目录是否位于正确的`Localization_File/output`目录下

2. **验证功能正常**：
   - 运行Extract模式，检查提取功能是否正常
   - 运行Extend模式，检查映射功能是否正常
   - 检查输出文件是否生成在正确位置

3. **验证自动化测试**：
   - 运行`automated_test.py`，确保所有测试用例通过
   - 检查测试过程中是否生成了正确的目录结构

## 预期效果

1. **目录结构规范**：
   - `Localization_File`目录与`Localization_Tool`目录同级
   - `Extract_Complete`和`Extend`目录位于正确的`Localization_File/output`目录下
   - 虚拟环境目录`.venv`位于`D:\Poki\Tool`目录下

2. **功能正常**：
   - 工具所有功能正常运行
   - 输出文件生成在正确位置
   - 自动化测试通过

3. **代码健壮**：
   - 目录路径计算逻辑更加健壮
   - 避免了因配置问题导致的目录结构错误
   - 提高了代码的可维护性和可靠性